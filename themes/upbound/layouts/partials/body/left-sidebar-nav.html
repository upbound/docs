<div class="left-sidebar-nav offcanvas-xl offcanvas-start" tabindex="-1" id="left-nav-offcanvas" aria-labelledby="left-nav-offcanvas">
    <nav aria-label="Documentation section navigation" class="container px-0" id="left-nav-menu">
        <div class="list-group top-level d-flex">
            <!-- Home link -->
            <div class="d-flex flex-row my-0 nav-parent-container position-relative list-group-item list-group-item-action {{if .IsHome }}active{{end}}" id="Home" style="padding-left: 1rem;">
                <a href="{{.Site.BaseURL}}" class="stretched-link">Home</a>
            </div>

            {{ $currentPage := . }}

            <!-- Define recursive template for rendering pages -->
            {{ define "render-pages" }}
                {{ $currentPage := .currentPage }}
                {{ $depth := .depth }}
                {{ range .pages }}
                    {{ if not .Params.tocHidden }}
                        {{ $hasPages := gt (len .Pages) 0 }}
                        {{ $pageId := substr (sha1 .Permalink) 0 8 }}
                        {{ $isActive := or (eq . $currentPage) (.IsAncestor $currentPage) }}
                        {{ $isCurrentPage := eq . $currentPage }}
                        <div class="list-group-item list-group-item-action nav-child child-link-container d-flex flex-row
                                  {{if $isActive}}active{{end}}
                                  {{if $isCurrentPage}}current-page{{end}}"
                             style="padding-left: {{ mul $depth 1.5 }}rem">
                            <div class="button-container left-offset">
                                {{ if $hasPages }}
                                    <div id="{{.File.UniqueID}}-button"
                                         class="mx-0 accordion-button accordion accordion-item {{if not $isActive}}collapsed{{end}}"
                                         type="button"
                                         data-bs-toggle="collapse"
                                         data-bs-target="#collapse-{{$pageId}}"
                                         aria-expanded="{{if $isActive}}true{{else}}false{{end}}"
                                         aria-controls="collapse-{{$pageId}}"
                                         title="Close/Expand">
                                    </div>
                                {{ end }}
                            </div>
                            <a href="{{.Permalink}}" class="child-link {{if not $hasPages}}stretched-link{{end}}">
                                {{ .Title }}
                            </a>
                        </div>
                        {{ if $hasPages }}
                            <div class="collapse {{if $isActive}}show{{end}}" id="collapse-{{$pageId}}">
                                {{ template "render-pages" dict "pages" .Pages "currentPage" $currentPage "depth" (add $depth 1) }}
                            </div>
                        {{ end }}
                    {{ end }}
                {{ end }}
            {{ end }}

            <!-- Section Headers and Content -->
            {{ range $category := slice "guides" "resources" }}
                <div class="d-flex flex-row my-0 nav-section-header text-gray" style="font-size: 0.875rem; font-weight: bold; padding-left: 1rem;">
                    <span class="section-title" style="font-weight: bold; text-decoration: none; display: inline-block;">{{ title $category }}</span>
                </div>
                <hr class="section-divider" style="border-top: 1px solid #ddd; margin: 0.5rem 0;"/>
                {{ range $.Site.Sections.ByWeight }}
                    {{ if eq .Params.category $category }}
                        {{ $isActive := or (eq . $currentPage) (.IsAncestor $currentPage) }}
                        {{ $id := substr (sha1 .Permalink) 0 8 }}

                        <div class="d-flex flex-row my-0 nav-parent-container position-relative {{if $isActive}}active{{end}}"
                             id="{{.Section}}"
                             data-bs-toggle="collapse"
                             data-bs-target="#collapse-{{$id}}"
                             aria-expanded="{{if $isActive}}true{{else}}false{{end}}">
                            <div class="button-container left-offset">
                                <div id="{{.Section}}-button"
                                     class="mx-0 accordion-button accordion accordion-item {{if not $isActive}}collapsed{{end}}"
                                     type="button"
                                     aria-controls="collapse-{{$id}}"
                                     title="Close/Expand">
                                </div>
                            </div>
                            <span class="nav-parent-title">{{.Title }}</span>
                        </div>

                        <div class="nav-child-container" id="{{.Section}}-children">
                            <div class="collapse list-group {{if $isActive}}show{{end}}" id="collapse-{{$id}}">
                                {{ if .Content }}
                                    {{ $isOverviewActive := eq $currentPage.Permalink .Permalink }}
                                    <div class="list-group-item list-group-item-action nav-child child-link-container d-flex flex-row
                                              {{if $isOverviewActive}}active current-page{{end}}">
                                        <div class="button-container left-offset"></div>
                                        <a href="{{.Permalink}}" class="stretched-link child-link {{if $isOverviewActive}}current-page-link{{end}}">
                                            Overview
                                        </a>
                                    </div>
                                {{ end }}
                                {{ template "render-pages" dict "pages" .Pages "currentPage" $currentPage "depth" 1 }}
                            </div>
                        </div>
                    {{ end }}
                {{ end }}
            {{ end }}
        </div>
    </nav>
</div>
