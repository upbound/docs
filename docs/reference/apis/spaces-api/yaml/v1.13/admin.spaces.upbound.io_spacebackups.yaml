---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: spacebackups.admin.spaces.upbound.io
spec:
  group: admin.spaces.upbound.io
  names:
    categories:
    - spaces
    kind: SpaceBackup
    listKind: SpaceBackupList
    plural: spacebackups
    singular: spacebackup
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .status.retries
      name: Retries
      type: integer
    - jsonPath: .spec.ttl
      name: TTL
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: SpaceBackup represents a backup of a Space.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: SpaceBackupSpec defines a backup over a set of Match
            properties:
              configRef:
                description: |-
                  ConfigRef is a reference to the space backup configuration.
                  ApiGroup is optional and defaults to "spaces.upbound.io".
                  Kind is required, and the only supported value is "SpaceBackupConfig" at
                  the moment.
                  Name is required.
                properties:
                  apiGroup:
                    description: APIGroup is the group for the resource being referenced.
                    type: string
                  kind:
                    description: Kind is the type of resource being referenced.
                    minLength: 1
                    type: string
                  name:
                    description: Name is the name of resource being referenced.
                    minLength: 1
                    type: string
                type: object
                x-kubernetes-map-type: atomic
                x-kubernetes-validations:
                - message: backup config ref must be a reference to a SpaceBackupConfig
                  rule: (!has(self.apiGroup) || self.apiGroup == 'admin.spaces.upbound.io')
                    && self.kind == 'SpaceBackupConfig'
                - message: backup config ref must have a name
                  rule: size(self.name) > 0
              controlPlaneBackups:
                description: ControlPlaneBackups is the definition of the control
                  plane backups,
                properties:
                  excludedResources:
                    description: |-
                      ExcludedResources is a slice of resource names that are not
                      included in the backup. Used to filter the included extra resources.
                    items:
                      type: string
                    type: array
                    x-kubernetes-list-type: set
                type: object
              deletionPolicy:
                default: Orphan
                description: DeletionPolicy is the policy for the backup.
                enum:
                - Orphan
                - Delete
                type: string
              exclude:
                description: |-
                  Exclude is the selector for resources that should be excluded from the backup.
                  If both Match and Exclude are specified, the Exclude selector will be applied
                  after the Match selector.
                  By default, only SpaceBackups are excluded.
                properties:
                  controlPlanes:
                    description: |-
                      ControlPlanes specifies the control planes selected.
                      A control plane is matched if any of the control plane selectors matches, if not specified
                      any control plane in the selected groups is matched.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                  extras:
                    description: Extras specifies the extra resources selected.
                    items:
                      description: GenericSpaceBackupResourceSelector represents a
                        generic resource selector.
                      properties:
                        apiGroup:
                          description: APIGroup is the group of the resource.
                          type: string
                        kind:
                          description: Kind is the kind of the resource.
                          type: string
                        labelSelectors:
                          description: |-
                            A resource is matched if any of the label selector matches.
                            In case when the list is empty, resource is matched too.
                          items:
                            description: |-
                              A label selector is a label query over a set of resources. The result of matchLabels and
                              matchExpressions are ANDed. An empty label selector matches all objects. A null
                              label selector matches no objects.
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector
                                  requirements. The requirements are ANDed.
                                items:
                                  description: |-
                                    A label selector requirement is a selector that contains values, a key, and an operator that
                                    relates the key and values.
                                  properties:
                                    key:
                                      description: key is the label key that the selector
                                        applies to.
                                      type: string
                                    operator:
                                      description: |-
                                        operator represents a key's relationship to a set of values.
                                        Valid operators are In, NotIn, Exists and DoesNotExist.
                                      type: string
                                    values:
                                      description: |-
                                        values is an array of string values. If the operator is In or NotIn,
                                        the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                        the values array must be empty. This array is replaced during a strategic
                                        merge patch.
                                      items:
                                        type: string
                                      type: array
                                      x-kubernetes-list-type: atomic
                                  required:
                                  - key
                                  - operator
                                  type: object
                                type: array
                                x-kubernetes-list-type: atomic
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: |-
                                  matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                  map is equivalent to an element of matchExpressions, whose key field is "key", the
                                  operator is "In", and the values array contains only "value". The requirements are ANDed.
                                type: object
                            type: object
                            x-kubernetes-map-type: atomic
                          type: array
                        names:
                          description: |-
                            A resource is selected if its metadata.name matches any of the provided names.
                            In case when the list is empty, resource is matched too.
                          items:
                            type: string
                          type: array
                          x-kubernetes-list-type: set
                      required:
                      - apiGroup
                      - kind
                      type: object
                    type: array
                  groups:
                    description: |-
                      Groups specifies the groups selected.
                      A group is matched if any of the group selectors matches, if not specified
                      any group is matched. Group selector is ANDed with all other selectors, so no resource in
                      a group not matching the group selector will be included in the backup.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                  secrets:
                    description: Spaces specifies the spaces selected.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                type: object
              match:
                description: |-
                  Match is the selector for resources that should be included in the backup.
                  By default, we'll back up all Groups and for each Group:
                  - All ControlPlanes.
                  - All Secrets.
                  - All other Space API resources, e.g. SharedBackupConfigs, SharedUpboundPolicies, Backups, etc...
                properties:
                  controlPlanes:
                    description: |-
                      ControlPlanes specifies the control planes selected.
                      A control plane is matched if any of the control plane selectors matches, if not specified
                      any control plane in the selected groups is matched.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                  extras:
                    description: Extras specifies the extra resources selected.
                    items:
                      description: GenericSpaceBackupResourceSelector represents a
                        generic resource selector.
                      properties:
                        apiGroup:
                          description: APIGroup is the group of the resource.
                          type: string
                        kind:
                          description: Kind is the kind of the resource.
                          type: string
                        labelSelectors:
                          description: |-
                            A resource is matched if any of the label selector matches.
                            In case when the list is empty, resource is matched too.
                          items:
                            description: |-
                              A label selector is a label query over a set of resources. The result of matchLabels and
                              matchExpressions are ANDed. An empty label selector matches all objects. A null
                              label selector matches no objects.
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector
                                  requirements. The requirements are ANDed.
                                items:
                                  description: |-
                                    A label selector requirement is a selector that contains values, a key, and an operator that
                                    relates the key and values.
                                  properties:
                                    key:
                                      description: key is the label key that the selector
                                        applies to.
                                      type: string
                                    operator:
                                      description: |-
                                        operator represents a key's relationship to a set of values.
                                        Valid operators are In, NotIn, Exists and DoesNotExist.
                                      type: string
                                    values:
                                      description: |-
                                        values is an array of string values. If the operator is In or NotIn,
                                        the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                        the values array must be empty. This array is replaced during a strategic
                                        merge patch.
                                      items:
                                        type: string
                                      type: array
                                      x-kubernetes-list-type: atomic
                                  required:
                                  - key
                                  - operator
                                  type: object
                                type: array
                                x-kubernetes-list-type: atomic
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: |-
                                  matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                  map is equivalent to an element of matchExpressions, whose key field is "key", the
                                  operator is "In", and the values array contains only "value". The requirements are ANDed.
                                type: object
                            type: object
                            x-kubernetes-map-type: atomic
                          type: array
                        names:
                          description: |-
                            A resource is selected if its metadata.name matches any of the provided names.
                            In case when the list is empty, resource is matched too.
                          items:
                            type: string
                          type: array
                          x-kubernetes-list-type: set
                      required:
                      - apiGroup
                      - kind
                      type: object
                    type: array
                  groups:
                    description: |-
                      Groups specifies the groups selected.
                      A group is matched if any of the group selectors matches, if not specified
                      any group is matched. Group selector is ANDed with all other selectors, so no resource in
                      a group not matching the group selector will be included in the backup.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                  secrets:
                    description: Spaces specifies the spaces selected.
                    properties:
                      labelSelectors:
                        description: |-
                          A resource is matched if any of the label selector matches.
                          In case when the list is empty, resource is matched too.
                        items:
                          description: |-
                            A label selector is a label query over a set of resources. The result of matchLabels and
                            matchExpressions are ANDed. An empty label selector matches all objects. A null
                            label selector matches no objects.
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: |-
                                  A label selector requirement is a selector that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: |-
                                      operator represents a key's relationship to a set of values.
                                      Valid operators are In, NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: |-
                                      values is an array of string values. If the operator is In or NotIn,
                                      the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                      the values array must be empty. This array is replaced during a strategic
                                      merge patch.
                                    items:
                                      type: string
                                    type: array
                                    x-kubernetes-list-type: atomic
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                              x-kubernetes-list-type: atomic
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: |-
                                matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                map is equivalent to an element of matchExpressions, whose key field is "key", the
                                operator is "In", and the values array contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                          x-kubernetes-map-type: atomic
                        type: array
                      names:
                        description: |-
                          A resource is selected if its metadata.name matches any of the provided names.
                          In case when the list is empty, resource is matched too.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                    type: object
                type: object
              ttl:
                description: |-
                  TTL is the time to live for the backup. After this time, the backup
                  will be eligible for garbage collection. If not set, the backup will
                  not be garbage collected.
                type: string
            required:
            - configRef
            type: object
            x-kubernetes-validations:
            - message: spec.configRef can't be changed or set after creation
              rule: '!has(self.configRef) && !has(oldSelf.configRef) || (self.configRef
                == oldSelf.configRef) '
            - message: spec.match can't be changed or set after creation
              rule: '!has(self.match) && !has(oldSelf.match) || (self.match == oldSelf.match) '
            - message: spec.exclude can't be changed or set after creation
              rule: '!has(self.exclude) && !has(oldSelf.exclude) || (self.exclude
                == oldSelf.exclude) '
            - message: spec.controlPlaneBackups can't be changed or set after creation
              rule: '!has(self.controlPlaneBackups) && !has(oldSelf.controlPlaneBackups)
                || (self.controlPlaneBackups == oldSelf.controlPlaneBackups) '
          status:
            description: SpaceBackupStatus represents the observed state of a SpaceBackup.
            properties:
              conditions:
                description: Conditions of the resource.
                items:
                  description: A Condition that may apply to a resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        LastTransitionTime is the last time this condition transitioned from one
                        status to another.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        A Message containing details about this condition's last transition from
                        one status to another, if any.
                      type: string
                    observedGeneration:
                      description: |-
                        ObservedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      type: integer
                    reason:
                      description: A Reason for this condition's last transition from
                        one status to another.
                      type: string
                    status:
                      description: Status of this condition; is it currently True,
                        False, or Unknown?
                      type: string
                    type:
                      description: |-
                        Type of this condition. At most one of each condition type may apply to
                        a resource at any point in time.
                      type: string
                  required:
                  - lastTransitionTime
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              observedGeneration:
                description: |-
                  ObservedGeneration is the latest metadata.generation
                  which resulted in either a ready state, or stalled due to error
                  it can not recover from without human intervention.
                format: int64
                type: integer
              phase:
                default: Pending
                description: Phase is the current phase of the backup.
                enum:
                - Pending
                - InProgress
                - Failed
                - Completed
                - Deleted
                type: string
              retries:
                description: Retries is the number of times the backup has been retried.
                format: int32
                type: integer
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
