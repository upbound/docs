---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: backups.admin.uxp.upbound.io
spec:
  group: admin.uxp.upbound.io
  names:
    categories:
    - admin
    kind: Backup
    listKind: BackupList
    plural: backups
    singular: backup
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .status.retries
      name: Retries
      type: integer
    - jsonPath: .spec.ttl
      name: TTL
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1beta1
    schema:
      openAPIV3Schema:
        description: Backup represents a backup of a Crossplane State.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: BackupSpec defines a backup for the Crossplane cluster.
            properties:
              configRef:
                description: ConfigRef is a reference to the backup configuration.
                properties:
                  name:
                    description: Name of the BackupConfig resource.
                    type: string
                required:
                - name
                type: object
              deletionPolicy:
                default: Orphan
                description: DeletionPolicy is the policy for the backup.
                enum:
                - Orphan
                - Delete
                type: string
              excludedResources:
                description: |-
                  ExcludedResources is a slice of resource names that are not
                  included in the backup. Used to filter the included extra resources.
                items:
                  type: string
                type: array
                x-kubernetes-list-type: set
              ttl:
                description: |-
                  TTL is the time to live for the backup. After this time, the backup
                  will be eligible for garbage collection. If not set, the backup will
                  not be garbage collected.
                type: string
            required:
            - configRef
            type: object
            x-kubernetes-validations:
            - message: backup excluded resources can not be changed after creation
              rule: (!has(self.excludedResources) && !has(oldSelf.excludedResources))
                || self.excludedResources == oldSelf.excludedResources
            - message: backup config ref can not be changed after creation
              rule: self.configRef == oldSelf.configRef
          status:
            description: BackupStatus represents the observed state of a Backup.
            properties:
              backupDirectory:
                description: |-
                  BackupDirectory is the directory name where the backup is stored in object storage.
                  This is used to ensure proper cleanup during deletion.
                type: string
              conditions:
                description: Conditions of the resource.
                items:
                  description: A Condition that may apply to a resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        LastTransitionTime is the last time this condition transitioned from one
                        status to another.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        A Message containing details about this condition's last transition from
                        one status to another, if any.
                      type: string
                    observedGeneration:
                      description: |-
                        ObservedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      type: integer
                    reason:
                      description: A Reason for this condition's last transition from
                        one status to another.
                      type: string
                    status:
                      description: Status of this condition; is it currently True,
                        False, or Unknown?
                      type: string
                    type:
                      description: |-
                        Type of this condition. At most one of each condition type may apply to
                        a resource at any point in time.
                      type: string
                  required:
                  - lastTransitionTime
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              observedGeneration:
                description: |-
                  ObservedGeneration is the latest metadata.generation
                  which resulted in either a ready state, or stalled due to error
                  it can not recover from without human intervention.
                format: int64
                type: integer
              phase:
                default: Pending
                description: Phase is the current phase of the backup.
                enum:
                - Pending
                - InProgress
                - Failed
                - Completed
                - Deleted
                type: string
              retries:
                description: Retries is the number of times the backup has been retried.
                format: int32
                type: integer
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
